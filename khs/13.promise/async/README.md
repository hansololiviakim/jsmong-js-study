# CONTENT

[0. 싱글 스레드 언어인 자바스크립트](#0-싱글-스레드-언어인-자바스크립트) <br />
[1. 자바스크립트의 실행](#1-자바스크립트의-실행) <br />
[2. 자바스크립트의 동작](#2-자바스크립트의-동작) <br />
[3. 자바스크립트에서 비동기 프로그래밍을 활용하는 이유](#3-자바스크립트에서-비동기-프로그래밍을-활용하는-이유) <br />
[4. 자바스크립트의 비동기 작업 처리](#4-자바스크립트의-비동기-작업-처리) <br />
[5. 비동기 작업의 흐름](#5-비동기-작업의-흐름)

<br /><br />

# 0. 싱글 스레드 언어인 자바스크립트

### 특징

- 하나의 싱글 컨텍스트 스택을 가지고 있다.

- 하나의 스트림 _(실행 컨텍스트의 흐름)_ 으로 단 한가지의 일만 처리할 수 있다.

- 자바스크립트는 다른 언어(ex. JAVA)와 달리 병렬로 작업을 여러개 처리하는데 사용되는 별도 스레드를 가질 수 없다.

<br />

### 왜 싱글 스레드 언어일까?

- 싱글 스레드 접근 방식은 자바스크립트를 간단하게 유지하고 스레드 관리에 따른 복잡성을 줄이는데 도움을 준다.

- 웹 페이지는 여러 요소와 이벤트를 다루어야 하기 떄문에 싱글 스레드가 유용하다.

- [참고] 웹 브라우저는 웹 워커(Web Workers)와 같은 별도의 스레드를 사용해 일부 작업을 병렬로 처리할 수 있다.

<br />

<details>
  <summary>[참고] 스레드</summary>

- 컴퓨터 프로세스 내에서 실행되는 실행 단위

- CPU에서 실행되는 가장 작은 단위

- 프로세스 내에서 독립적으로 실행되는 작업 단위

</details>

<br /><br />

# 1. 자바스크립트의 실행

자바스크립트의 실행은 실행 컨텍스트와 콜 스택을 통해 관리된다.

- **실행 컨텍스트 (Excution Context)**

  - 자바스크립트 코드가 실행되는 환경

  - 전역 실행 컨텍스트와 함수 실행 컨텍스트가 있음

- **콜 스택 (Call Stack)**

  - 함수 호출이 쌓이는 스택 구조

  - 함수가 호출될 때마다 새로운 실행 컨텍스트가 스택에 push되고, 함수 실행이 끝나면 pop

<br /><br />

# 2. 자바스크립트의 동작

- 자바스크립트는 단일 스레드로 동작한다.

- 따라서 한 시점에 하나의 함수만 실행할 수 있으며, 여러 함수가 동시에 실행될 수 없다.

<br /><br />

# 3. 자바스크립트에서 비동기 프로그래밍을 활용하는 이유

비동기 프로그래밍을 활용하면 다음과 같은 이유로 더 효율적이고 반응성이 좋은 애플리케이션을 만들 수 있다.

1. **I/O 작업 처리**

   - 파일 읽기/쓰기, 네트워크 요청, 데이터베이스 쿼리 등과 같은 I/O 작업은 시간이 많이 걸릴 수 있음

   - 이러한 작업을 동기적으로 처리하면 블로킹이 발생하여 다른 작업이 중단됨

   - 비동기 프로그래밍을 사용하면 이러한 I/O 작업이 완료될 때까지 기다리지 않고 다른 작업을 계속 진행할 수 있음

2. **사용자 경험 개선**

   - 비동기 프로그래밍을 통해 긴 작업이 진행되는 동안에도 UI가 계속 반응할 수 있게 함

   - 예를 들어, 사용자가 버튼을 클릭하면 네트워크 요청을 보내는 동안 애니메이션이나 로딩 인디케이터를 표시할 수 있음

3. **서버 성능 향상**

   - Node.js와 같은 서버 측 자바스크립트 환경에서는 비동기 프로그래밍이 매우 중요

   - 하나의 스레드로 많은 클라이언트 요청을 효율적으로 처리할 수 있음

   - 비동기 I/O를 통해 많은 동시 요청을 처리하면서도 서버 자원을 효율적으로 사용할 수 있음

4. **병렬 작업**

   - 웹 워커와 같은 기능을 통해 자바스크립트에서도 어느 정도 병렬 처리가 가능

   - 백그라운드에서 작업을 수행함으로써 메인 스레드의 작업 흐름을 방해하지 않음

5. **프로그래밍 패턴의 발전**

   - 콜백(callback), 프로미스(Promise), async/await 등의 비동기 프로그래밍 패턴은 자바스크립트 코드의 가독성을 높이고 유지보수를 용이하게 함

   - 특히 async/await 패턴은 동기 코드처럼 보이지만 비동기 작업을 효과적으로 처리할 수 있게 함

<br /><br />

# 4. 자바스크립트의 비동기 작업 처리

비동기 처리는 자바스크립트가 싱글 스레드 모델을 유지하면서도 효율적으로 작업을 처리할 수 있게 해주는 매커니즘이다. 여기서 중요한 역할을 하는게 `이벤트 루프`이다.

이벤트 루프와 비동기 작업을 통해 자바스크립트는 여러 작업을 효율적으로 처리할 수 있고, 사용자 인터페이스가 멈추지 않고 응답성을 유지할 수 있게 된다.

- **이벤트 루프 (Event Loop)**

  - 콜 스택과 작업 큐 (task queue)를 모니터링

  - 콜스택이 비어있는 경우 작업 큐에서 대기 중인 콜백을 가져와 실행

- **작업 큐 (Task Queue) / 이벤트 큐 (Event Queue)**

  - 비동기 작업의 콜백 함수가 대기하는 큐

  - 비동기 작업이 완료되면 해당 콜백 함수가 큐에 추가됨

<br /><br />

# 5. 비동기 작업의 흐름

비동기 작업을 통해 자바스크립트는 동시에 여러 작업을 수행하는 것처럼 보이나, 실제로는 콜백 함수가 순차적으로 실행된다.

1. **초기화**

   - 자바스크립트 엔진이 실행되면, 전역 실행 컨텍스트(Global Excution Context)가 콜 스택에 푸시

2. **전역 코드 실행**

   - 전역 코드가 실행되면서 함수 선언 및 변수 선언이 처리됨

   - 전역 코드 실행 중 함수가 호출되면, 해당 함수의 실행 컨텍스트가 콜 스택에 추가됨

3. **함수 내부 실행**

   - 함수 내부 코드가 실행되며 추가 함수 호출이 발생할 수 있으며, 각각의 호출은 콜스택에 추가됨

4. **비동기 작업 시작**

   - 함수 내부에서 비동기 작업(ex. 타이머 설정이나 네트워크 요청)이 시작됨

   - 비동기 작업이 시작되면 해당 작업은 자바스크립트 엔진이 아닌 브라우저나 Node.js 런타임 환경에서 처리됨

5. **함수 반환 및 스택 제거**

   - 함수가 실행을 마치면 콜 스택에서 해당 함수의 실행 컨텍스트가 제거됨

   - 이는 모든 호출된 함수에 대해 반복

6. **콜백 함수 등록**

   - 비동기 작업이 완료되면 실행될 콜백 함수가 작업 큐(task queue)에 등록됨

7. **이벤트 루프 실행**

   - 콜 스택이 비어 있는 경우 이벤트 루프(event loop)가 작업 큐에서 대기 중인 콜백 함수를 가져와 콜 스택에 푸시하고 실행

8. **비동기 콜백 함수 실행**

   - 작업 큐에 등록된 콜백 함수가 콜 스택에 추가되어 실행됨

   - 콜백 함수 내에서 추가 함수 호출이 발생할 수 있으며, 이는 다시 콜 스택에 추가됨

9. **가비지 컬렉션**

   - 메모리 힙에서 더이상 참조되지 않는 객체들은 가비지 컬렉션을 통해 제거됨
   - 자바스크립트 엔진은 주기적으로 힙을 검사하여 메모리를 효율적으로 관리함

<br />

### 예시

```javascript
console.log("Start");

setTimeout(() => {
  console.log("Timeout");
}, 1000);

console.log("End");
```

1. ‘Start’ 콘솔 출력

2. setTimeout 함수가 호출되어 1초 후 실행될 콜백 등록

3. ‘End’ 콘솔 출력

4. 1초 후, 타이머가 만료되면 콜백 함수가 작업 큐에 추가됨

5. 이벤트 루프가 콜백 함수를 작업 큐에서 가져와 콜 스택에 푸시하고 실행

6. ‘Timeout’ 콘솔 출력
